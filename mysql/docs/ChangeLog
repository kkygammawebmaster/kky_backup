------------------------------------------------------------
revno: 3249
committer: Alfranio Correia <alfranio.correia@oracle.com>
branch nick: mysql-5.5.18-release
timestamp: Wed 2011-11-02 15:28:18 +0000
message:
  BUG#13337202 - REPLICATION PERFORMANCE DROP DUE TO "THE BINLOG MAY BE CORRUPTED" FLOOD
  
  In patch mysql-5.5:revno:3097.92.133, we made the gcc 4.6.1 compiler
  to stop complaining about the fact that binlog_can_be_corrupted was
  defined but not used. The fix consisted in checking the variable
  and printing a warning message.
  
  However, the fix caused a regression as a message was being printed
  out when there was no corrupted binary log causing performance
  problems and triggering users' suspicions when there was no need.
  
  In BUG#13337202, we do not print any message and use the variable
  in an "if" with an empty body to keep the compiler happy.
------------------------------------------------------------
revno: 3248 [merge]
tags: clone-5.5.18-build
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-5.5-security
timestamp: Wed 2011-10-26 12:28:40 +0300
message:
  Null merge from mysql-5.1-security.
    ------------------------------------------------------------
    revno: 2661.768.36
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.1-security
    timestamp: Wed 2011-10-26 12:23:57 +0300
    message:
      Revert revno:3452.71.32 (Bug#12612184 fix).
      
      Bug#12612184 RACE CONDITION AFTER BTR_CUR_PESSIMISTIC_UPDATE()
      
      The fix introduced potentially more severe crash recovery problems
      than the bug causes. Revert the fix for now.
    ------------------------------------------------------------
    revno: 2661.768.35
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.1-security
    timestamp: Wed 2011-10-26 11:44:28 +0300
    message:
      Revert most of revno 3560.9.1 (Bug#12704861)
      
      This was an attempt to address problems with the Bug#12612184 fix.
      Even with this follow-up fix, crash recovery can be broken.
      Let us fix the bug later.
------------------------------------------------------------
revno: 3247 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-5.5-security
timestamp: Wed 2011-10-26 10:06:23 +0300
message:
  Merge mysql-5.1-security to mysql-5.5-security.
    ------------------------------------------------------------
    revno: 2661.768.34
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.1-security
    timestamp: Wed 2011-10-26 09:38:28 +0300
    message:
      Copy and adapt innodb_misc1.test from innodb to innodb_plugin.
    ------------------------------------------------------------
    revno: 2661.768.33
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.1-security
    timestamp: Wed 2011-10-26 09:34:32 +0300
    message:
      Fix results after Bug#12661768 fix.
------------------------------------------------------------
revno: 3246 [merge]
committer: Marko M?kel? <marko.makela@oracle.com>
branch nick: mysql-5.5-security
timestamp: Tue 2011-10-25 18:06:05 +0300
message:
  Merge mysql-5.1-security to mysql-5.5-security.
    ------------------------------------------------------------
    revno: 2661.768.32
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.1-security
    timestamp: Tue 2011-10-25 17:58:34 +0300
    message:
      Fix results after Bug#12661768 fix.
    ------------------------------------------------------------
    revno: 2661.768.31
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.1-security
    timestamp: Tue 2011-10-25 17:33:38 +0300
    message:
      Bug#13002783 PARTIALLY UNINITIALIZED CASCADE UPDATE VECTOR
      
      In the ON UPDATE CASCADE clause of FOREIGN KEY constraints, the
      calculated update vector was not fully initialized. This bug was
      introduced in the InnoDB Plugin when implementing support for
      ROW_FORMAT=DYNAMIC.
      
      Additionally, the data type information was not initialized, but
      apparently it has never been needed in this case.  Nevertheless, it is
      not good programming practice to pass uninitialized values around.
      
      calc_row_difference(): Declare the update field uninitialized in
      Valgrind. Copy the data type information as well, except when the
      field is SQL NULL. In the built-in InnoDB, initialize
      ufield->extern_storage = FALSE (an initialization bug that had gone
      unnoticed this far). The InnoDB Plugin and later have this flag to
      dfield_t and have always initialized it properly.
      
      row_ins_cascade_calc_update_vec(): Reduce the scope of some
      pointers. Initialize orig_len. (This caused the bug in InnoDB Plugin
      and later.)
      
      row_ins_foreign_check_on_constraint(): Simplify a condition. Declare
      the update vector uninitialized.
      
      rb:771 approved by Jimmy Yang
------------------------------------------------------------
revno: 3245 [merge]
committer: Vasil Dimov <vasil.dimov@oracle.com>
branch nick: mysql-5.5-security
timestamp: Tue 2011-10-25 16:48:23 +0300
message:
  Merge mysql-5.1-security -> mysql-5.5-security (Fix Bug#12661768)
    ------------------------------------------------------------
    revno: 2661.768.30
    committer: Vasil Dimov <vasil.dimov@oracle.com>
    branch nick: mysql-5.1-security
    timestamp: Tue 2011-10-25 16:46:38 +0300
    message:
      Fix Bug#12661768 UPDATE IGNORE CRASHES SERVER IF TABLE IS INNODB AND IT IS
      PARENT FOR OTHER ONE
      
      Do not try to lookup key_nr'th key in 'table' because there may not be such
      a key there. key_nr is the number of the key in the _child_ table name, not
      in the parent table.
      
      Instead just print the fields of the record that are covered by the first key
      defined on the parent table.
      
      This bug gets a better fix in MySQL 5.6, which is too risky for 5.1 and 5.5.
      
      Approved by:	Jon Olav Hauglid (via IM)
------------------------------------------------------------
revno: 3244 [merge]
committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
branch nick: mysql-5.5-security
timestamp: Mon 2011-10-24 14:03:19 +0400
message:
  Empty merge from mysql-5.1-security.
    ------------------------------------------------------------
    revno: 2661.768.29 [merge]
    committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
    branch nick: mysql-5.1-security
    timestamp: Mon 2011-10-24 12:44:27 +0400
    message:
      Auto-merge from mysql-5.1.
------------------------------------------------------------
revno: 3243 [merge]
committer: Alexander Nozdrin <alexander.nozdrin@oracle.com>
branch nick: mysql-5.5-security
timestamp: Mon 2011-10-24 13:21:32 +0400
message:
  Auto-merge from mysql-5.5.
    ------------------------------------------------------------
    revno: 3097.92.145 [merge]
    committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
    branch nick: mysql-5.5
    timestamp: Mon 2011-10-24 13:48:54 +0530
    message:
      Local merge from mysql-5.1.
        ------------------------------------------------------------
        revno: 2661.787.47
        committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
        branch nick: mysql-5.1
        timestamp: Mon 2011-10-24 13:35:28 +0530
        message:
          WL#5945 - Improve libedit library
          
          Fixed a misplaced parenthesis, injected due to
          syncing from libedit CVS head.
    ------------------------------------------------------------
    revno: 3097.92.144
    committer: Dmitry Lenev <Dmitry.Lenev@oracle.com>
    branch nick: mysql-5.5-13116518
    timestamp: Sun 2011-10-23 09:37:35 +0400
    message:
      Fix for bug #13116518 - "OPEN_TABLES() SHOULD NOT ALLOCATE AND FREE 
      NEW_FRM_MEM WITHOUT NEEDING TO".
      
      During the process of opening tables for a statement, we allocated
      memory which was used only during view loading even in cases when the
      statement didn't use any views. Such an unnecessary allocation (and
      corresponding freeing) might have caused significant performance
      overhead in some workloads. For example, it caused up to 15% slowdown
      in a simple stored routine calculating Fibonacci's numbers.
      
      This memory was pre-allocated as part of "new_frm_mem" MEM_ROOT
      initialization at the beginning of open_tables(). 
      
      This patch addresses this issue by turning off memory pre-allocation
      during initialization for this MEM_ROOT. Now, memory on this root
      will be allocated only at the point when the first .FRM for a view is 
      opened.
      
      The patch doesn't contain a test case since it is hard to test the
      performance improvements or the absence of memory allocation in our
      test framework.
    ------------------------------------------------------------
    revno: 3097.92.143 [merge]
    committer: Ashish Agarwal<ashish.y.agarwal@oracle.com>
    branch nick: bug_793_5.5
    timestamp: Sat 2011-10-22 17:04:38 +0530
    message:
      bug#11758979 - 51252: ARCHIVE TABLES STILL FAIL UNDER STRESS
                            TESTS: CRASH, CORRUPTION, 4G MEMOR
      
      Issue: Valgrind errors due to checksum and optimize
             query against archive tables with null columns.
             Table record buffer was not initialized.
      
      Solution: Initialize the record buffer.
        ------------------------------------------------------------
        revno: 3097.115.1
        committer: Ashish Agarwal<ashish.y.agarwal@oracle.com>
        branch nick: bug_793_5.5
        timestamp: Fri 2011-10-21 16:19:58 +0530
        message:
          bug#11758979 - 51252: ARCHIVE TABLES STILL FAIL UNDER STRESS
                                TESTS: CRASH, CORRUPTION, 4G MEMOR
          
          Issue: Valgrind errors due to checksum and optimize 
                 query angaist archive tables with null columns.
                 Table record buffer was not initialized.
          
          Solution: Initialize the record buffer.
    ------------------------------------------------------------
    revno: 3097.92.142 [merge]
    committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
    branch nick: mysql-5.5
    timestamp: Fri 2011-10-21 18:14:35 +0530
    message:
      Merge of fix for bug#13106585 from mysql-5.1.
        ------------------------------------------------------------
        revno: 2661.787.46
        committer: Nirbhay Choubey <nirbhay.choubey@oracle.com>
        branch nick: B13106585-5.1
        timestamp: Fri 2011-10-21 18:10:12 +0530
        message:
          Bug#13106585 PUSH FOR "WL#5945 : IMPROVE LIBEDIT LIBRARY"
                       BREAKS SOURCE RELEASE BUILD
          
          Some of the required files were not getting copied while
          performing 'make dist' and hence the build failed for
          the created distribution source.
          
          Added the missing files to Makefile.am.
    ------------------------------------------------------------
    revno: 3097.92.141 [merge]
    committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
    branch nick: mysql-5.5-push
    timestamp: Fri 2011-10-21 09:35:07 +0400
    message:
      Merge.
        ------------------------------------------------------------
        revno: 2661.787.45 [merge]
        committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
        branch nick: mysql-5.1-push
        timestamp: Fri 2011-10-21 09:30:56 +0400
        message:
          Merge.
            ------------------------------------------------------------
            revno: 2661.795.1
            committer: Sergey Vojtovich <sergey.vojtovich@oracle.com>
            branch nick: mysql-5.1-bug49030
            timestamp: Thu 2011-10-20 15:03:22 +0400
            message:
              BUG#11757032 - 49030: OPTIMIZE TABLE BREAKS MYISAM TABLE WHEN
                             USING MYISAM_USE_MMAP ON WINDOWS
              
              When OPTIMIZE/REPAIR TABLE is switching to new data file,
              old data file is removed while memory mapping is still
              active.
              
              With 5.1 implementation of nt_share_delete() it is not
              permitted to remove mmaped file.
              
              This fix disables memory mapping for mi_repair() operations.
    ------------------------------------------------------------
    revno: 3097.92.140 [merge]
    committer: Marko M?kel? <marko.makela@oracle.com>
    branch nick: mysql-5.5
    timestamp: Fri 2011-10-21 06:54:49 +0300
    message:
      Merge mysql-5.1 to mysql-5.5.
        ------------------------------------------------------------
        revno: 2661.787.44
        committer: Marko M?kel? <marko.makela@oracle.com>
        branch nick: mysql-5.1
        timestamp: Fri 2011-10-21 06:32:16 +0300
        message:
          Bug#13116045 Compilation failure using GCC 4.6.1 in btr/btr0cur.c
          
          btr_record_not_null_field_in_rec(): Remove the parameter rec.
          Use rec_offs_nth_sql_null() instead of rec_get_nth_field().
          
          rb:788 approved by Jimmy Yang
    ------------------------------------------------------------
    revno: 3097.92.139 [merge]
    committer: Bjorn Munch <bjorn.munch@oracle.com>
    branch nick: testcr-55
    timestamp: Wed 2011-10-19 23:44:17 +0200
    message:
      Removing copyright headers from test files
        ------------------------------------------------------------
        revno: 2661.787.43
        committer: Bjorn Munch <bjorn.munch@oracle.com>
        branch nick: testcr-51
        timestamp: Wed 2011-10-19 13:36:57 +0200
        message:
          Remove copyright header from parser_stack.test
    ------------------------------------------------------------
    revno: 3097.92.138 [merge]
    committer: Joerg Bruehe <joerg.bruehe@oracle.com>
    branch nick: mysql-5.5
    timestamp: Wed 2011-10-19 13:39:43 +0200
    message:
      Merge the changes of 5.5.17 back into main 5.5
        ------------------------------------------------------------
        revno: 3097.114.4
        tags: mysql-5.5.17
        committer: Joerg Bruehe <joerg.bruehe@oracle.com>
        branch nick: clone-5.5
        timestamp: Tue 2011-10-04 12:28:30 +0200
        message:
          Exclude NDB man pages from a source tarball,
          these sources don't have any current NDB.
